name: npm-build

on:
  workflow_dispatch:
  push:
    branches: [ main ]
    paths-ignore:
      - '**/README.md'
  pull_request:
    branches: [ main ]
    paths-ignore:
      - '**/README.md'

jobs:
  npm-build:
    runs-on: ubuntu-latest
    steps:
      - name: Install Wine
        run: sudo apt-get install -y wine64
  
      - name: Checkout code
        uses: actions/checkout@v2
  
      - name: Install dependencies
        run: npm install
        
      - name: Install dependencies
        run: npm install electron-builder -g

      - name: Build
        run: electron-builder -w 

      - name: Deploy to gh-pages
        uses: s0/git-publish-subdir-action@develop
        env:
          REPO: self
          BRANCH: gh-pages
          FOLDER: dist
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          MESSAGE: "deploy website"
